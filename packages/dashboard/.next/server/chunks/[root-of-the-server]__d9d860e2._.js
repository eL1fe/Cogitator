module.exports=[93695,(e,t,n)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},18622,(e,t,n)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,n)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,n)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},70406,(e,t,n)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},45329,e=>{"use strict";var t=e.i(51710),n=e.i(74963),r=e.i(81706),a=e.i(98867),o=e.i(5893),s=e.i(46463),i=e.i(23368),l=e.i(34613),d=e.i(40066),p=e.i(11516),c=e.i(40564),u=e.i(73827),h=e.i(73483),f=e.i(12582),y=e.i(74641),g=e.i(93695);e.i(48763);var m=e.i(4458);let R=process.env.OLLAMA_URL||"http://localhost:11434";async function x(e){try{let{model:t,messages:n,temperature:r=.7,tools:a=[]}=await e.json();if(!t||!n)return new Response(JSON.stringify({error:"Model and messages required"}),{status:400,headers:{"Content-Type":"application/json"}});if(!t.includes("gpt")&&!t.includes("claude")&&!t.includes("gemini"))return v(t,n,r);return w(t,n,r)}catch(e){return console.error("Playground error:",e),new Response(JSON.stringify({error:"Failed to process request"}),{status:500,headers:{"Content-Type":"application/json"}})}}async function v(e,t,n){let r=await fetch(`${R}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:e,messages:t,stream:!0,options:{temperature:n}})});if(!r.ok||!r.body)return new Response(JSON.stringify({error:"Ollama request failed"}),{status:500,headers:{"Content-Type":"application/json"}});let a=new TextEncoder,o=r.body.getReader();return new Response(new ReadableStream({async start(e){try{for(;;){let{done:t,value:n}=await o.read();if(t){e.enqueue(a.encode('data: {"done":true}\n\n')),e.close();break}for(let t of new TextDecoder().decode(n).split("\n").filter(Boolean))try{let n=JSON.parse(t);n.message?.content&&e.enqueue(a.encode(`data: ${JSON.stringify({content:n.message.content,done:n.done||!1,total_duration:n.total_duration,eval_count:n.eval_count,prompt_eval_count:n.prompt_eval_count})}

`))}catch{}}}catch(t){e.enqueue(a.encode(`data: {"error":"${t}"}

`)),e.close()}}}),{headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}async function w(e,t,n){let r,a,o,s,i=e.includes("gpt")||e.includes("o1"),l=e.includes("claude"),d=e.includes("gemini");if(i){if(!(r=process.env.OPENAI_API_KEY))return new Response(JSON.stringify({error:"OpenAI API key not configured"}),{status:400,headers:{"Content-Type":"application/json"}});a="https://api.openai.com/v1/chat/completions",o={"Content-Type":"application/json",Authorization:`Bearer ${r}`},s={model:e,messages:t,temperature:n,stream:!0}}else if(l){if(!(r=process.env.ANTHROPIC_API_KEY))return new Response(JSON.stringify({error:"Anthropic API key not configured"}),{status:400,headers:{"Content-Type":"application/json"}});a="https://api.anthropic.com/v1/messages",o={"Content-Type":"application/json","x-api-key":r,"anthropic-version":"2023-06-01"};let n=t.find(e=>"system"===e.role);s={model:e,messages:t.filter(e=>"system"!==e.role),system:n?.content,max_tokens:4096,stream:!0}}else{if(!d)return new Response(JSON.stringify({error:"Unknown model provider"}),{status:400,headers:{"Content-Type":"application/json"}});if(!(r=process.env.GOOGLE_API_KEY))return new Response(JSON.stringify({error:"Google API key not configured"}),{status:400,headers:{"Content-Type":"application/json"}});let i=e.replace("gemini-","");a=`https://generativelanguage.googleapis.com/v1beta/models/gemini-${i}:streamGenerateContent?key=${r}`,o={"Content-Type":"application/json"},s={contents:t.map(e=>({role:"assistant"===e.role?"model":"user",parts:[{text:e.content}]})),generationConfig:{temperature:n}}}let p=await fetch(a,{method:"POST",headers:o,body:JSON.stringify(s)});if(!p.ok){let e=await p.text();return new Response(JSON.stringify({error:`API error: ${e}`}),{status:500,headers:{"Content-Type":"application/json"}})}if(!p.body)return new Response(JSON.stringify({error:"No response body"}),{status:500,headers:{"Content-Type":"application/json"}});let c=new TextEncoder,u=p.body.getReader();return new Response(new ReadableStream({async start(e){try{for(;;){let{done:t,value:n}=await u.read();if(t){e.enqueue(c.encode('data: {"done":true}\n\n')),e.close();break}let r=new TextDecoder().decode(n);if(i)for(let t of r.split("\n").filter(e=>e.startsWith("data: "))){let n=t.slice(6);if("[DONE]"!==n)try{let t=JSON.parse(n),r=t.choices?.[0]?.delta?.content;r&&e.enqueue(c.encode(`data: ${JSON.stringify({content:r})}

`))}catch{}}else if(l)for(let t of r.split("\n").filter(e=>e.startsWith("data: ")))try{let n=JSON.parse(t.slice(6));if("content_block_delta"===n.type){let t=n.delta?.text;t&&e.enqueue(c.encode(`data: ${JSON.stringify({content:t})}

`))}}catch{}else if(d)try{let t=JSON.parse(r);if(Array.isArray(t))for(let n of t){let t=n.candidates?.[0]?.content?.parts?.[0]?.text;t&&e.enqueue(c.encode(`data: ${JSON.stringify({content:t})}

`))}}catch{}}}catch(t){e.enqueue(c.encode(`data: {"error":"${t}"}

`)),e.close()}}}),{headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}e.s(["POST",()=>x,"dynamic",0,"force-dynamic","runtime",0,"nodejs"],25020);var C=e.i(25020);let O=new t.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/playground/route",pathname:"/api/playground",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/packages/dashboard/src/app/api/playground/route.ts",nextConfigOutput:"",userland:C}),{workAsyncStorage:E,workUnitAsyncStorage:T,serverHooks:N}=O;function A(){return(0,r.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:T})}async function S(e,t,r){O.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/playground/route";R=R.replace(/\/index$/,"")||"/";let x=await O.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:v,params:w,nextConfig:C,parsedUrl:E,isDraftMode:T,prerenderManifest:N,routerServerContext:A,isOnDemandRevalidate:S,revalidateOnlyGenerated:b,resolvedPathname:_,clientReferenceManifest:P,serverActionsManifest:k}=x,j=(0,i.normalizeAppPath)(R),q=!!(N.dynamicRoutes[j]||N.routes[_]),I=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,E,!1):t.end("This page could not be found"),null);if(q&&!T){let e=!!N.routes[_],t=N.dynamicRoutes[j];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await I();throw new g.NoFallbackError}}let $=null;!q||O.isDev||T||($="/index"===($=_)?"/":$);let J=!0===O.isDev||!q,H=q&&!J;k&&P&&(0,s.setManifestsSingleton)({page:R,clientReferenceManifest:P,serverActionsManifest:k});let U=e.method||"GET",D=(0,o.getTracer)(),M=D.getActiveScopeSpan(),K={params:w,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:J,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,r,a)=>O.onRequestError(e,t,r,a,A)},sharedContext:{buildId:v}},F=new l.NodeNextRequest(e),L=new l.NodeNextResponse(t),B=d.NextRequestAdapter.fromNodeNextRequest(F,(0,d.signalFromNodeResponse)(t));try{let s=async e=>O.handle(B,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=D.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=n.get("next.route");if(r){let t=`${U} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${R}`)}),i=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var o,l;let d=async({previousCacheEntry:n})=>{try{if(!i&&S&&b&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await s(a);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let d=K.renderOpts.collectedTags;if(!q)return await (0,u.sendResponse)(F,L,o,K.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(o.headers);d&&(t[y.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,r=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:m.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:r}}}}catch(t){throw(null==n?void 0:n.isStale)&&await O.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:S})},!1,A),t}},p=await O.handleResponse({req:e,nextConfig:C,cacheKey:$,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:b,responseGenerator:d,waitUntil:r.waitUntil,isMinimalMode:i});if(!q)return null;if((null==p||null==(o=p.value)?void 0:o.kind)!==m.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",S?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),T&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,h.fromNodeOutgoingHttpHeaders)(p.value.headers);return i&&q||g.delete(y.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,f.getCacheControlHeader)(p.cacheControl)),await (0,u.sendResponse)(F,L,new Response(p.value.body,{headers:g,status:p.value.status||200})),null};M?await l(M):await D.withPropagatedContext(e.headers,()=>D.trace(p.BaseServerSpan.handleRequest,{spanName:`${U} ${R}`,kind:o.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},l))}catch(t){if(t instanceof g.NoFallbackError||await O.onRequestError(e,t,{routerKind:"App Router",routePath:j,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:S})},!1,A),q)throw t;return await (0,u.sendResponse)(F,L,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>A,"routeModule",()=>O,"serverHooks",()=>N,"workAsyncStorage",()=>E,"workUnitAsyncStorage",()=>T],45329)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__d9d860e2._.js.map